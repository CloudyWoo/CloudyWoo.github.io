---
layout: single

title:  "MongoDB Datatypes"
excerpt: ""

categories: 
    - MongoDB
tags: [nosql, mongodb]

toc: true
author_profile: false
sidebar:
    nav: "docs"

date: 2022-08-20
last_modified_at: 2022-08-20
---

몽고DB는 도큐먼트의 값으로 다양한 데이터형을 지원한다.
1. 기본 데이터형
2. 날짜
3. 배열
4. 내장 도큐먼트

#### 기본 데이터형
- null: null값과 존재하지 않는 필드 표현에 사용 `{"x" : null}`
- 불리언: 참/거짓 `{"x": true}`
- 숫자
  - 셸은 **64비트 부동소수점 수를 기본**으로 사용 
    `{"x" : 3.14}` `{"x" : 3}`
  - 4 또는 8 바이트의 signed integer는 각각 NumberInt 혹은 NumberLong 클래스를 사용
    `{"x" : NumberInt("3")}` `{"x" : NumberLong("3")}`
- 문자열: 어떤 UTF-8 문자열이든 표현 가능 `{"x" : "foobar"}`
- 날짜
  - 1970년 1월 1일부터 시간을 1/1000초 단위로 나타내는 64비트 정수로 날짜를 표시함
  - 표준시간대(time zone)은 저장하지 않음
  `{"x" : new Date()}`
- 정규표현식: 쿼리는 자바스크립트의 정규 표현식 문법 사용 가능 `{"x" : /foobar/i}`
- 배열 : 값의 셋이나 리스트를 배열로 표현 가능 `{"x" : ["a", "b", "c"]}`
- 내장 도큐먼트: 부모 도큐먼트의 값으로 내장된 도큐먼트 전체 포함 `{"x" : {"foo" : "bar"}}`
- 객체 ID: 도큐먼트용 12바이트 ID로 상대적으로 덜 사용됨 `{"x": ObjectId()}`
- 이진 데이터
  - 임의의 바이트 문자열로 셸에서 조작이 불가능함
  - DB에 UTF-8이 아닌 문자열을 저장하는 유일한 방법임
- 코드
  - 쿼리와 도큐먼트는 임의의 자바스크립트 코드를 포함할 수 있음 `{"x" : function() { /*...*/}}`
  - 추후 추가 예정

#### 날짜
- **JS의 Date 클래스**는 몽고DB의 날짜를 표현하는 데 사용
- new Date()를 호출 (O) / Date() (X)
- Date()이 아닌 이유
  - 함수로 생성자를 호출하면 실제 Date 객체가 아닌 날짜의 문자열 표현을 반환함(JS 작동방식)

#### 배열
- 정렬 연산과 비정렬 연산에 호환성 있게 사용 가능
  - 정렬 연산(ordered operation) : 리스트, 스택, 큐
  - 비정렬 연산(unordered operation) : 셋

  다음 예제를 관찰하며 배열 자료형에 대해 좀 더 알아보자.
  `{"things" : ["pie", 3.14]}` 도큐먼트에서 "things" 키는 배열값을 가짐
  - 서로 다른 데이터형의 값 포함 가능
  - 일반적인 키/값 쌍을 지원하는 어떤 데이터형 값이든 될 수 있음

  도큐먼트 내 배열의 장점은?
  - 몽고DB가 배열의 구조를 이해함 + 배열의 내용에 작업을 수행하기 위해 내부에 도달하는 방법을 앎
  - 배열에 쿼리하거나 배열의 내용을 이용해 인덱스를 만들 수 있음
  - 위 예제에서 3.14가 "things" 배열의 요소인 모든 도큐먼트를 쿼리함
    자주 쓰는 쿼리라면 "things" 키를 인덱스로 생성하면 쿼리 속도가 향상됨
  - 배열 내부에 도달해서 원자적으로("pie" 값을 pi로) 배열의 내용 수정 가능

#### 내장 도큐먼트
- 도큐먼트가 다른 도큐먼트의 키에 대한 값이 된 경우
- 내장 도큐먼트를 사용한다면 데이터를 키/값 쌍만의 단순한 평면구조보다 더 풍부하고 자연스러운 표현이 가능함

##### 예제
다음 예제는 "address" 키에 대한 값이 "street", "city", "state"의 키/값 쌍을 갖는 내장 도큐먼트임
```
{
    "name" : "John Doe",
    "address" : {
        "street" : "123 Park Street",
        "city" : "Anytown",
        "state" : "NY"
    }
} 
```
- (배열과 마찬가지로) 내장 도큐먼트 구조를 '이해', 인덱스 구성, 쿼리, 갱신하기 위해 도큐먼트 내부에 접근
- 관계형 DB에서 이 도큐먼트 두 개의 테이블(people과 addresses)에 분리된 두 개의 행으로 모델링됨
  반면, 몽고DB에서는 "people"라는 도큐먼트 내에 "addresses"라는 도큐먼트를 내장할 수 있음

##### 몽고DB의 단점 - 데이터 반복
- 더 많은 **데이터 반복(data repetition)**이 생길 수 있다는 단점 존재
- 관계형 DB에서 address가 분리된 테이블이 있고, 주소의 오타를 고쳐야 한다고 가정해보자.
  <span style="skyblue">관계형 DB에선 poeple과 addresses를 join하면 같은 주소를 갖는 모든 사람의 주소를 수정</span>할 수 있다.
  반면, <span style="orange">몽고DB에서는 각 사람의 도큐먼트에서 오타를 수정해야 한다.</span>


#### _id와 ObjectId
